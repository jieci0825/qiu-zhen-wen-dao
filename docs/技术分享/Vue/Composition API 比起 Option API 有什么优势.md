---
title: Composition API 比起 Option API 有什么优势
---

# Composition API 比起 Option API 有什么优势

- **更好的逻辑复用**：通过组合函数可以让逻辑复用变得更加的简洁和高效，而选项式中实现这点的方式是 mixins，而mixins存在一些明显的缺陷，主要是三个方面，如下:

  - **不清晰的数据来源**：当使用了多个 mixin 时，实例上的数据属性来自哪个 mixin 变得不清晰，这使追溯实现和理解组件行为变得困难；在组合式函数中使用 ref + 解构模式，可以让属性的来源在组件中一目了然
  - **命名空间冲突**：多个来自不同作者的 mixin 可能会注册相同的属性名，造成命名冲突；若使用组合式函数，你可以通过在解构变量时对变量进行重命名来避免相同的键名
  - **隐式的跨 mixin 交流**：多个 mixin 需要依赖共享的属性名来进行相互作用，这使得它们隐性地耦合在一起；而一个组合式函数的返回值可以作为另一个组合式函数的参数被传入，像普通函数那样

- **更灵活的代码组织**：选项式 API 在默认情况下就能够让人写出有组织的代码：大部分代码都自然地被放进了对应的选项里。但是选项式 API 在单个组件的逻辑复杂到一定程度时，会面临一些无法忽视的限制。这些限制主要体现在需要处理多个**逻辑关注点**的组件中；这个用一张图就可以很好的说明，如图：

  <img src="http://cos.coderjc.cn/blog/62783026-810e6180-ba89-11e9-8774-e7771c8095d6.png" alt="62783026-810e6180-ba89-11e9-8774-e7771c8095d6" />

- **更好的类型推导**：随着 typescript 的流行，使用 typescript 来书写更加健壮的代码，但是选项式 api 设计时间过早，设计之初就没有考虑这一点，所以针对选项式的类型推导处理自然就不会很理想，相比之下，组合式 api 主要利用基本的变量和函数，它们本身就是类型友好的。用组合式 API 重写的代码可以享受到完整的类型推导，不需要书写太多类型标注

- **更小的生产包体积**：主要是对于代码的压缩更加友好；这是由于 `<script setup>` 形式书写的组件模板被编译为了一个内联函数，和 `<script setup>` 中的代码位于同一作用域。不像选项式 API 需要依赖 `this` 上下文对象访问属性，被编译的模板可以直接访问 `<script setup>` 中定义的变量，无需从实例中代理。这对代码压缩更友好，因为本地变量的名字可以被压缩，但对象的属性名则不能。